{"version":3,"sources":["webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/double-slider/index.js","webpack:///./src/pages/products/list/products-header.js","webpack:///./src/pages/products/list/index.js","webpack:///./src/utils/fetch-json.js"],"names":["SortableTable","constructor","headersConfig","url","isSortLocally","sorted","id","find","item","sortable","order","emptyPlaceholder","isRowALink","event","target","closest","preventDefault","this","dataset","Array","from","subElements","header","children","map","cell","sortOnClient","sortOnServer","async","firePointer","Math","max","document","body","scrollHeight","documentElement","offsetHeight","clientHeight","window","pageYOffset","isLoading","loadStart","loadLength","loadedData","loadData","length","removeEventListener","scrollHandler","updateTableData","data","headerConfig","render","element","createElement","innerHTML","getTable","firstElementChild","getSubElements","getHeaderRow","initEventListeners","title","join","getBodyRows","rowData","getBodyRow","template","addEventListener","classList","remove","add","sortedData","sort","column","sortType","customSorting","productA","productB","a","b","result","localeCompare","Date","parentElement","querySelectorAll","reduce","accum","subElement","sortId","sortOrder","start","setLoadingInd","URL","process","searchParams","set","toString","fetchJson","href","removeLoadingInd","loading","style","display","pointerdownHandler","destroy","DoubleSlider","min","formatValue","value","selected","to","left","innerLeft","right","innerRight","width","inner","getBoundingClientRect","dragging","thumbLeft","newLeft","clientX","shiftX","parseFloat","thumbRight","progress","getValue","newRight","onThumbPointerMove","onThumbPointerUp","dispatchEvent","CustomEvent","detail","bubbles","ondragstart","update","onThumbPointerDown","elements","rangeTotal","floor","resetSelected","thumbElem","round","category","Page","wrapper","initComponents","renderComponents","productsContainer","sliderContainer","filterFrom","filterTo","components","Object","keys","forEach","key","hasOwnProperty","append","updateComponents","filterTitle","filterStatus","String","timerId","filterName","clearTimeout","setTimeout","hasAttribute","resetFilters","component","values","params","response","fetch","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","reason","alert"],"mappings":"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","file":"products-list-index-js-5.js","sourcesContent":["import fetchJson from \"../../utils/fetch-json.js\";\n\nconst BACKEND_URL = process.env.BACKEND_URL;\n\nexport default class SortableTable {\n  element = null;\n  subElements = {};\n  data = [];\n  loadStart = 0;\n  loadLength = 30;\n  isLoading = false;\n\n  pointerdownHandler = event => {\n    const target = event.target.closest('[data-sortable = \"true\"]');\n\n    if (!target) return;\n\n    event.preventDefault();\n\n    this.sorted.id = target.dataset.id;\n    this.sorted.order = (target.dataset.order === 'desc') ? 'asc' : 'desc';\n\n    Array.from(this.subElements.header.children).map(cell => cell.dataset.order = '');\n    target.dataset.order = this.sorted.order;\n\n    if (this.isSortLocally) {\n      this.sortOnClient(this.sorted.id, this.sorted.order);\n    } else {\n      this.sortOnServer(this.sorted.id, this.sorted.order);\n    }\n  }\n\n  scrollHandler = async event => {\n    if (this.isSortLocally) return;\n\n    let scrollHeight = Math.max(\n      document.body.scrollHeight, document.documentElement.scrollHeight,\n      document.body.offsetHeight, document.documentElement.offsetHeight,\n      document.body.clientHeight, document.documentElement.clientHeight\n    );\n\n    const firePointer = scrollHeight - document.documentElement.clientHeight;\n\n    if (window.pageYOffset === firePointer && !this.isLoading) {\n      this.loadStart = this.loadStart + this.loadLength;\n\n      this.isLoading = true;\n\n      const loadedData = await this.loadData();\n\n      if (loadedData.length === 0 || loadedData.length < this.loadLength) {\n        document.removeEventListener('scroll', this.scrollHandler);\n      }\n\n      this.updateTableData([...this.data, ...loadedData]);\n\n      this.isLoading = false;\n    }\n  }\n\n  constructor(headersConfig = [], {\n    url = '',\n    isSortLocally = false,\n    sorted = {\n      id: headersConfig.find(item => item.sortable).id,\n      order: 'asc'\n    },\n    emptyPlaceholder = '<div><p>No data</p></div>',\n    isRowALink = true\n  } = {}) {\n    this.url = url;\n    this.isSortLocally = isSortLocally;\n    this.headerConfig = headersConfig;\n    this.sorted = sorted;\n    this.emptyPlaceholder = emptyPlaceholder;\n    this.isRowALink = isRowALink;\n\n    this.render();\n  }\n\n  async render() {\n    const element = document.createElement('div');\n    const {id, order} = this.sorted;\n\n    element.innerHTML = this.getTable();\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    const data = await this.loadData(id, order);\n\n    this.subElements.header.innerHTML = this.getHeaderRow();\n\n    this.subElements.emptyPlaceholder.innerHTML = this.emptyPlaceholder;\n\n    this.updateTableData(data);\n    this.initEventListeners();\n  }\n\n  getTable() {\n    return `\n      <div class=\"sortable-table\">\n          <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\"></div>\n          <div data-element=\"body\" class=\"sortable-table__body\"></div>\n          <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\n          <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\"></div>\n      </div>\n    `;\n  }\n\n  getHeaderRow() {\n    return this.headerConfig.map(({id, sortable, title}) => {\n      const order = (id === this.sorted.id) ? this.sorted.order : '';\n\n      return `\n        <div class=\"sortable-table__cell\"\n            data-id=\"${id}\"\n            data-sortable=\"${sortable}\"\n            data-order=\"${order}\"\n            <span>${title}</span>\n            <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\n                <span class=\"sort-arrow\"></span>\n            </span>\n        </div>\n      `;\n    }).join('');\n  }\n\n  getBodyRows(data) {\n    return data.map(rowData => {\n      return this.isRowALink ?\n        `<a href=\"/products/${rowData.id}\" class=\"sortable-table__row\">${this.getBodyRow(rowData)}</a>` :\n        `<div class=\"sortable-table__row\">${this.getBodyRow(rowData)}</div>`;\n    }).join('');\n  }\n\n  getBodyRow(rowData) {\n    return Array.from(this.headerConfig).map(({id, template}) => {\n      if (template) {\n        return template(rowData[id]);\n      } else {\n        return `<div class=\"sortable-table__cell\">${rowData[id]}</div>`;\n      }\n    }).join('');\n  }\n\n  async update(url) {\n    this.url = url;\n    this.loadStart = 0;\n\n    const loadedData = await this.loadData();\n\n    if (loadedData.length) {\n      document.addEventListener('scroll', this.scrollHandler);\n    }\n    this.updateTableData(loadedData);\n  }\n\n  updateTableData(data) {\n    this.data = data;\n\n    if (data.length) {\n      this.element.classList.remove('sortable-table_empty');\n\n      if (this.isSortLocally) {\n        Array.from(this.subElements.header.children).map(cell => cell.dataset.order = '');\n      }\n\n      this.subElements.body.innerHTML = this.getBodyRows(data);\n    } else {\n      this.element.classList.add('sortable-table_empty');\n    }\n  }\n\n  sortOnClient(id, order) {\n    const sortedData = this.sort(id, order);\n\n    this.subElements.body.innerHTML = this.getBodyRows(sortedData);\n  }\n\n  async sortOnServer(id, order) {\n    this.loadStart = 0;\n\n    const loadedData = await this.loadData(id, order);\n\n    if (loadedData.length) {\n      document.addEventListener('scroll', this.scrollHandler);\n    }\n    this.updateTableData(loadedData);\n  }\n\n  sort(id, order) {\n    const column = this.headerConfig.find(item => item.id === id);\n    const {sortType, customSorting} = column;\n\n    return Array.from(this.data).sort((productA, productB) => {\n      const a = productA[id];\n      const b = productB[id];\n      let result = null;\n\n      switch (sortType) {\n        case 'number':\n          result = a - b;\n          break;\n        case 'string':\n          result = a.localeCompare(b, ['ru-u-kf-upper', 'en-u-kf-upper']);\n          break;\n        case 'date':\n          result = new Date(a) - new Date(b);\n          break;\n        case 'custom':\n          result = customSorting(a, b);\n          break;\n        default:\n          result = a - b;\n      }\n\n      if (order === 'asc') {\n        return result;\n      } else if (order === 'desc') {\n        return -result;\n      }\n    });\n  }\n\n  getSubElements(parentElement) {\n    const elements = parentElement.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  async loadData(sortId = this.sorted.id,\n                 sortOrder = this.sorted.order,\n                 start = this.loadStart,\n                 length = this.loadLength) {\n    if (!this.url) return;\n\n    this.setLoadingInd();\n\n    const url = new URL(this.url, BACKEND_URL);\n    url.searchParams.set('_sort', sortId);\n    url.searchParams.set('_order', sortOrder);\n    url.searchParams.set('_start', start.toString());\n    url.searchParams.set('_end', (start + length).toString());\n\n    let loadedData = [];\n\n    loadedData = await fetchJson(url.href);\n\n    this.removeLoadingInd();\n\n    return loadedData;\n  }\n\n  setLoadingInd() {\n    this.subElements.loading.style.display = 'block';\n  }\n\n  removeLoadingInd() {\n    this.subElements.loading.style.display = 'none';\n  }\n\n  initEventListeners () {\n    this.subElements.header.addEventListener('pointerdown', this.pointerdownHandler);\n    document.addEventListener('scroll', this.scrollHandler);\n  }\n\n  remove () {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    document.removeEventListener('scroll', this.scrollHandler);\n  }\n}\n","export default class DoubleSlider {\n  element;\n  subElements = {};\n\n  onThumbPointerMove = event => {\n    event.preventDefault();\n\n    const { left: innerLeft, right: innerRight, width } = this.subElements.inner.getBoundingClientRect();\n\n    if (this.dragging === this.subElements.thumbLeft) {\n      let newLeft = (event.clientX - innerLeft + this.shiftX) / width;\n\n      if (newLeft < 0) {\n        newLeft = 0;\n      }\n      newLeft *= 100;\n      const right = parseFloat(this.subElements.thumbRight.style.right);\n\n      if (newLeft + right > 100) {\n        newLeft = 100 - right;\n      }\n\n      this.dragging.style.left = this.subElements.progress.style.left = newLeft + '%';\n      this.subElements.from.innerHTML = this.formatValue(this.getValue().from);\n    }\n\n    if (this.dragging === this.subElements.thumbRight) {\n      let newRight = (innerRight - event.clientX - this.shiftX) / width;\n\n      if (newRight < 0) {\n        newRight = 0;\n      }\n      newRight *= 100;\n\n      const left = parseFloat(this.subElements.thumbLeft.style.left);\n\n      if (left + newRight > 100) {\n        newRight = 100 - left;\n      }\n      this.dragging.style.right = this.subElements.progress.style.right = newRight + '%';\n      this.subElements.to.innerHTML = this.formatValue(this.getValue().to);\n    }\n  };\n\n  onThumbPointerUp = () => {\n    this.element.classList.remove('range-slider_dragging');\n\n    document.removeEventListener('pointermove', this.onThumbPointerMove);\n    document.removeEventListener('pointerup', this.onThumbPointerUp);\n\n    this.element.dispatchEvent(new CustomEvent('range-select', {\n      detail: this.getValue(),\n      bubbles: true\n    }));\n  };\n\n  constructor({\n    min = 100,\n    max = 200,\n    formatValue = value => '$' + value,\n    selected = {\n      from: min,\n      to: max\n    }\n  } = {}) {\n    this.min = min;\n    this.max = max;\n    this.formatValue = formatValue;\n    this.selected = selected;\n\n    this.render();\n  }\n\n  get template() {\n    return `<div class=\"range-slider\">\n      <span data-element=\"from\"></span>\n      <div data-element=\"inner\" class=\"range-slider__inner\">\n        <span data-element=\"progress\" class=\"range-slider__progress\"></span>\n        <span data-element=\"thumbLeft\" class=\"range-slider__thumb-left\"></span>\n        <span data-element=\"thumbRight\" class=\"range-slider__thumb-right\"></span>\n      </div>\n      <span data-element=\"to\"></span>\n    </div>`;\n  }\n\n  render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    this.element.ondragstart = () => false;\n\n    this.subElements = this.getSubElements(element);\n\n    this.initEventListeners();\n\n    this.update();\n  }\n\n  initEventListeners() {\n    const { thumbLeft, thumbRight } = this.subElements;\n\n    thumbLeft.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n    thumbRight.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n  }\n\n  getSubElements(element) {\n    const result = {};\n    const elements = element.querySelectorAll('[data-element]');\n\n    for (const subElement of elements) {\n      const name = subElement.dataset.element;\n\n      result[name] = subElement;\n    }\n\n    return result;\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n    document.removeEventListener('pointermove', this.onThumbPointerMove);\n    document.removeEventListener('pointerup', this.onThumbPointerUp);\n  }\n\n  update() {\n    const rangeTotal = this.max - this.min;\n    const left = Math.floor((this.selected.from - this.min) / rangeTotal * 100) + '%';\n    const right = Math.floor((this.max - this.selected.to) / rangeTotal * 100) + '%';\n\n    this.subElements.progress.style.left = left;\n    this.subElements.progress.style.right = right;\n\n    this.subElements.thumbLeft.style.left = left;\n    this.subElements.thumbRight.style.right = right;\n\n    this.subElements.from.innerHTML = this.formatValue(this.selected.from);\n    this.subElements.to.innerHTML = this.formatValue(this.selected.to);\n  }\n\n  resetSelected() {\n    this.selected.from = this.min;\n    this.selected.to = this.max;\n    this.update();\n  }\n\n  onThumbPointerDown(event) {\n    const thumbElem = event.target;\n\n    event.preventDefault();\n\n    const { left, right } = thumbElem.getBoundingClientRect();\n\n    if (thumbElem === this.subElements.thumbLeft) {\n      this.shiftX = right - event.clientX;\n    } else {\n      this.shiftX = left - event.clientX;\n    }\n\n    this.dragging = thumbElem;\n\n    this.element.classList.add('range-slider_dragging');\n\n    document.addEventListener('pointermove', this.onThumbPointerMove);\n    document.addEventListener('pointerup', this.onThumbPointerUp);\n  }\n\n  getValue() {\n    const rangeTotal = this.max - this.min;\n    const { left } = this.subElements.thumbLeft.style;\n    const { right } = this.subElements.thumbRight.style;\n\n    const from = Math.round(this.min + parseFloat(left) * 0.01 * rangeTotal);\n    const to = Math.round(this.max - parseFloat(right) * 0.01 * rangeTotal);\n\n    return { from, to };\n  }\n}\n","const header = [\n  {\n    id: 'images',\n    title: 'Image',\n    sortable: false,\n    template: data => {\n      const img = data[0] ? `<img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">` : ``;\n      return `\n          <div class=\"sortable-table__cell\">\n            ${img}\n          </div>`;\n    }\n  },\n  {\n    id: 'title',\n    title: 'Name',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'subcategory',\n    title: 'Category',\n    sortable: false,\n    template: data => {\n      return `<div class=\"sortable-table__cell\">\n                <span data-tooltip=\"<div class='sortable-table-tooltip'>\n                            <span class='sortable-table-tooltip__category'>${data.category.title}</span> /\n                            <b class='sortable-table-tooltip__subcategory'>${data.title}</b>\n                          </div>\">\n                  ${data.title}\n                </span>\n              </div>`;\n    }\n  },\n  {\n    id: 'quantity',\n    title: 'Quantity',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'price',\n    title: 'Price',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `<div class=\"sortable-table__cell\">$${data}</div>`;\n    }\n  },\n  {\n    id: 'status',\n    title: 'Status',\n    sortable: true,\n    sortType: 'string',\n    template: data => {\n      return `<div class=\"sortable-table__cell\">${data === 1 ? 'Active' : 'Not active'}</div>`;\n    }\n  },\n];\n\nexport default header;\n","import SortableTable from '../../../components/sortable-table/index.js';\nimport DoubleSlider from '../../../components/double-slider/index.js';\nimport header from './products-header.js';\n\nconst DEFAULT_FILTER_FROM = 0;\nconst DEFAULT_FILTER_TO = 4000;\nconst BACKEND_URL = process.env.BACKEND_URL;\n\nexport default class Page {\n  element = null;\n  subElements = {};\n  components = {};\n  filterTitle = '';\n  filterStatus = '';\n  filterFrom = DEFAULT_FILTER_FROM;\n  filterTo = DEFAULT_FILTER_TO;\n\n  render() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = this.template;\n    this.element = wrapper.firstElementChild;\n\n    this.subElements = this.getSubElements(this.element);\n\n    this.initComponents();\n    this.renderComponents();\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  initComponents() {\n    const productsContainer = new SortableTable(header, {\n      url: `api/rest/products?_embed=subcategory.category`,\n      emptyPlaceholder: `<div>\n                            <p>No products found matching the selected criteria</p>\n                            <button type=\"button\" class=\"button-primary-outline\" data-clear-filters>Clear filters</button>\n                         </div>`\n    });\n\n    const sliderContainer = new DoubleSlider({\n      min: this.filterFrom,\n      max: this.filterTo\n    });\n\n    this.components = {\n      productsContainer,\n      sliderContainer\n    };\n  }\n\n  renderComponents() {\n    Object.keys(this.subElements).forEach(key => {\n      if (this.components.hasOwnProperty(key)) {\n        this.subElements[key].append(this.components[key].element);\n      }\n    });\n  }\n\n  updateComponents({\n    filterTitle = this.filterTitle,\n    filterStatus = this.filterStatus,\n    filterFrom = this.filterFrom,\n    filterTo = this.filterTo\n  } = {}) {\n    const url = new URL(`/api/rest/products`, BACKEND_URL);\n\n    url.searchParams.set('_embed', 'subcategory.category');\n    url.searchParams.set('price_gte', String(filterFrom));\n    url.searchParams.set('price_lte', String(filterTo));\n\n    if (filterTitle) {\n      url.searchParams.set('title_like', filterTitle);\n    }\n    if (filterStatus) {\n      url.searchParams.set('status', filterStatus);\n    }\n\n    this.components.productsContainer.update(url);\n  }\n\n  initEventListeners() {\n    let timerId;\n\n    this.subElements.filterStatus.addEventListener('change', event => {\n      this.filterStatus = event.target.value;\n\n      this.updateComponents({\n        filterStatus: this.filterStatus\n      });\n    });\n\n    this.subElements.filterName.addEventListener('input', event => {\n      this.filterTitle = event.target.value;\n\n      clearTimeout(timerId);\n\n      timerId = setTimeout(() => {\n        this.updateComponents({\n          filterTitle: this.filterTitle\n        });\n      }, 100);\n    });\n\n    this.subElements.productsContainer.addEventListener('pointerdown', event => {\n      if (event.target.hasAttribute('data-clear-filters')) {\n        this.resetFilters();\n        this.updateComponents();\n      }\n    });\n\n    this.subElements.sliderContainer.addEventListener('range-select', event => {\n      this.filterFrom = event.detail.from;\n      this.filterTo = event.detail.to;\n\n      this.updateComponents({\n        filterFrom: this.filterFrom,\n        filterTo: this.filterTo\n      });\n    });\n  }\n\n  resetFilters() {\n    this.filterTitle = '';\n    this.filterStatus = '';\n    this.filterFrom = DEFAULT_FILTER_FROM;\n    this.filterTo = DEFAULT_FILTER_TO;\n\n    this.subElements.filterName.value = '';\n    this.subElements.filterStatus.value = '';\n    this.components.sliderContainer.resetSelected();\n  }\n\n  get template() {\n    return `\n        <div class=\"products-list\">\n          <div class=\"content__top-panel\">\n            <h1 class=\"page-title\">Products</h1>\n            <a href=\"/products/add\" class=\"button-primary\">Add product</a>\n          </div>\n          <div class=\"content-box content-box_small\">\n            <form class=\"form-inline\">\n              <div class=\"form-group\">\n                <label class=\"form-label\">Sort by:</label>\n                <input type=\"text\" data-element=\"filterName\" class=\"form-control\" placeholder=\"Product name\">\n              </div>\n              <div class=\"form-group\" data-element=\"sliderContainer\">\n                <label class=\"form-label\">Price:</label>\n              </div>\n              <div class=\"form-group\">\n                <label class=\"form-label\">Status:</label>\n                <select class=\"form-control\" data-element=\"filterStatus\">\n                  <option value=\"\" selected=\"\">Any</option>\n                  <option value=\"1\">Active</option>\n                  <option value=\"0\">Not active</option>\n                </select>\n              </div>\n            </form>\n          </div>\n          <div data-element=\"productsContainer\" class=\"products-list__container\"></div>\n        </div>`;\n  }\n\n  getSubElements(element) {\n    const subElements = element.querySelectorAll('[data-element]');\n\n    return [...subElements].reduce((result, subElement) => {\n      result[subElement.dataset.element] = subElement;\n\n      return result;\n    }, {});\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = null;\n\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n"],"sourceRoot":""}