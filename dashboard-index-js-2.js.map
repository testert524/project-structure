{"version":3,"sources":["webpack:///./src/components/column-chart/index.js","webpack:///./src/pages/dashboard/bestsellers-header.js","webpack:///./src/pages/dashboard/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/utils/helpers.js","webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/range-picker/index.js"],"names":["ColumnChart","constructor","url","range","from","Date","to","label","link","formatHeading","data","this","render","initEventListeners","update","renderElement","subElements","getSubElements","element","setLoadingInd","loadData","renderChart","setNewRange","removeLoadingInd","remove","destroy","URL","process","searchParams","set","toISOString","fetchJson","href","parentElement","querySelectorAll","reduce","accum","dataset","classList","add","getLink","document","createElement","innerHTML","chartHeight","firstElementChild","header","columnChart","body","dataProps","getColumnProps","length","Object","values","sum","value","dateOptions","year","month","day","map","item","itemDate","date","toLocaleDateString","relativeValue","join","addEventListener","event","target","hasAttribute","currentTarget","dataValues","maxValue","Math","max","scale","entries","String","floor","id","title","sortable","template","sortType","category","Page","setUTCMonthCorrectly","getUTCMonth","wrapper","initComponents","renderComponents","rangePicker","RangePicker","ordersChart","salesChart","toLocaleString","customersChart","sortableTable","SortableTable","isSortLocally","components","keys","forEach","key","append","detail","updateComponents","result","subElement","component","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","window","reason","alert","d","getUTCDate","setUTCMonth","Number","setUTCDate","headersConfig","sorted","find","order","emptyPlaceholder","isRowALink","closest","preventDefault","Array","children","cell","sortOnClient","sortOnServer","async","firePointer","scrollHeight","documentElement","offsetHeight","clientHeight","pageYOffset","isLoading","loadStart","loadLength","loadedData","removeEventListener","scrollHandler","updateTableData","headerConfig","getTable","getHeaderRow","getBodyRows","rowData","getBodyRow","sortedData","sort","column","customSorting","productA","productB","a","b","localeCompare","sortId","sortOrder","start","loading","style","display","pointerdownHandler","contains","dateValue","selectingFrom","removeSelected","selected","highlightDates","updateInput","closeSelector","dispatchEvent","CustomEvent","bubbles","className","direction","slice","lastIndexOf","showDateFrom","renderSelector","selector","trim","toggle","isOpen","isChildOfRangePicker","getUTCMidnight","getTime","renderSkeleton","input","toggleSelector","handleDatePick","handleClickOutside","formatDate","initialDate","controlArrows","arrow","handleControlArrows","insertAdjacentHTML","renderMonths","fromTS","toTS","datesButtons","getDatesButtons","firstButtonTS","parse","lastButtonTS","button","buttonDateTS","firstMonthDate","months","initTime","i","push","renderOneMoth","toDateTime","timeZone","renderDatesButtons","boundaryValues","getBoundaryValues","startFrom","firstDayNumber","dateButtons","lastDate","getUTCDay","dateToTransform","dateStyle","getUTCFullYear","selectedClasses","apply","el","UTC","getFullYear","getMonth","getDate"],"mappings":"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","file":"dashboard-index-js-2.js","sourcesContent":["import fetchJson from \"../../utils/fetch-json.js\";\n\nconst BACKEND_URL = process.env.BACKEND_URL;\n\nexport default class ColumnChart {\n  element = null;\n  subElements = {};\n  chartHeight = 50;\n\n  constructor({\n                url = '',\n                range = {\n                  from: new Date(),\n                  to: new Date(),\n                },\n                label = '',\n                link = '',\n                formatHeading = data => data\n              } = {}) {\n    this.url = url;\n    this.range = range;\n    this.label = label;\n    this.link = link;\n    this.formatHeading = formatHeading;\n\n    this.render();\n    this.initEventListeners();\n    this.update(this.range.from, this.range.to);\n  }\n\n  render() {\n    this.renderElement();\n    this.subElements = this.getSubElements(this.element);\n  }\n\n  async update(from, to) {\n    this.setLoadingInd();\n    const data = await this.loadData(from, to);\n    this.renderChart(data);\n    this.setNewRange(from, to);\n    this.removeLoadingInd();\n\n    return data;\n  }\n\n  remove () {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n  }\n\n  async loadData(from, to) {\n    const url = new URL(this.url, BACKEND_URL);\n\n    url.searchParams.set('from', from.toISOString());\n    url.searchParams.set('to', to.toISOString());\n\n    return await fetchJson(url.href);\n  }\n\n  getSubElements(parentElement) {\n    const elements = parentElement.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, element) => {\n      accum[element.dataset.element] = element;\n\n      return accum;\n    }, {});\n  }\n\n  setLoadingInd() {\n    this.element.classList.add('column-chart_loading');\n  }\n\n  removeLoadingInd() {\n    this.element.classList.remove('column-chart_loading');\n  }\n\n  getLink() {\n    return this.link ? `<a href=\"${this.link}\" class=\"column-chart__link\">View all</a>` : '';\n  }\n\n  renderElement() {\n    const element = document.createElement('div');\n\n    element.innerHTML = `\n    <div class=\"column-chart column-chart_loading\" style=\"--chart-height: ${this.chartHeight}\">\n      <div class=\"column-chart__title\">\n        ${this.label}\n        ${this.getLink()}\n      </div>\n      <div class=\"column-chart__container\">\n        <div data-element=\"header\" class=\"column-chart__header\"></div>\n        <div data-element=\"body\" class=\"column-chart__chart\">\n        </div>\n      </div>\n    </div>\n    `;\n\n    this.element = element.firstElementChild;\n  }\n\n  renderChart(data = {}) {\n    const header = this.subElements.header;\n    const columnChart = this.subElements.body;\n    const dataProps = this.getColumnProps(data);\n\n    if (dataProps.length === 0) {\n      columnChart.innerHTML = '';\n      header.innerHTML = this.formatHeading(0);\n\n      return;\n    }\n\n    header.innerHTML = this.formatHeading(Object.values(data).reduce((sum, value) => sum + value));\n\n    const dateOptions = { year: 'numeric', month: 'short', day: 'numeric' };\n\n    columnChart.innerHTML = dataProps.map(item => {\n      const date = new Date(item.date);\n      const itemDate = date.toLocaleDateString('ru', dateOptions);\n\n      return `<div style=\"--value: ${item.relativeValue}\"\n                   data-tooltip=\"<div>\n                                   <small>${itemDate}</small>\n                                 </div>\n                                 <strong>${this.formatHeading(item.value)}</strong>\">\n              </div>`\n    }).join('');\n  }\n\n  setNewRange(from, to) {\n    this.from = from;\n    this.to = to;\n  }\n\n  initEventListeners() {\n    this.subElements.body.addEventListener('mouseover', event => {\n      if (event.target.hasAttribute('data-tooltip') ) {\n        event.currentTarget.classList.add('has-hovered');\n        event.target.classList.add('is-hovered');\n      }\n    });\n\n    this.subElements.body.addEventListener('mouseout', event => {\n      if (event.target.hasAttribute('data-tooltip') ) {\n        event.currentTarget.classList.remove('has-hovered');\n        event.target.classList.remove('is-hovered');\n      }\n    });\n  }\n\n  getColumnProps(data) {\n    const dataValues = Object.values(data);\n    const maxValue = Math.max(...dataValues);\n    const scale = this.chartHeight / maxValue;\n\n    return Object.entries(data).map(([date, value]) => {\n      return {\n        date,\n        value,\n        relativeValue: String(Math.floor(value * scale)),\n      };\n    });\n  }\n}\n","const header = [\n  {\n    id: 'images',\n    title: 'Image',\n    sortable: false,\n    template: data => {\n      return `\n          <div class=\"sortable-table__cell\">\n            <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">\n          </div>\n        `;\n    }\n  },\n  {\n    id: 'title',\n    title: 'Name',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'subcategory',\n    title: 'Category',\n    sortable: false,\n    template: data => {\n      return `<div class=\"sortable-table__cell\">\n                <span data-tooltip=\"<div class='sortable-table-tooltip'>\n                            <span class='sortable-table-tooltip__category'>${data.category.title}</span> /\n                            <b class='sortable-table-tooltip__subcategory'>${data.title}</b>\n                          </div>\">\n                  ${data.title}\n                </span>\n              </div>`;\n    }\n  },\n  {\n    id: 'quantity',\n    title: 'Quantity',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'price',\n    title: 'Price',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `<div class=\"sortable-table__cell\">$${data}</div>`;\n    }\n  },\n  {\n    id: 'sales',\n    title: 'Sales',\n    sortable: true,\n    sortType: 'number',\n  },\n];\n\nexport default header;\n","import RangePicker from '../../components/range-picker/index.js';\nimport SortableTable from '../../components/sortable-table/index.js';\nimport ColumnChart from '../../components/column-chart/index.js';\nimport setUTCMonthCorrectly from '../../utils/helpers.js';\nimport header from './bestsellers-header.js';\n\nexport default class Page {\n  element = null;\n  subElements = {};\n\n  constructor() {\n    this.range = {\n      from: new Date(),\n      to: new Date(),\n    };\n    this.range.from = setUTCMonthCorrectly(this.range.from, this.range.from.getUTCMonth() - 1);\n  }\n\n  render() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = this.template;\n\n    this.element = wrapper.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.initComponents();\n    this.renderComponents();\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  initComponents() {\n    const rangePicker = new RangePicker(this.range);\n\n    const ordersChart = new ColumnChart({\n      range: this.range,\n      url: 'api/dashboard/orders',\n      label: 'Orders',\n      link: '/sales'\n    });\n\n    const salesChart = new ColumnChart({\n      range: this.range,\n      url: 'api/dashboard/sales',\n      label: 'Sales',\n      formatHeading: data => `$${data.toLocaleString('en-US')}`\n    });\n\n    const customersChart = new ColumnChart({\n      range: this.range,\n      url: 'api/dashboard/customers',\n      label: 'Customers'\n    });\n\n    const sortableTable = new SortableTable(header, {\n      url: `api/dashboard/bestsellers?from=${this.range.from.toISOString()}&to=${this.range.to.toISOString()}`,\n      isSortLocally: true\n    });\n\n    this.components = {\n      rangePicker,\n      ordersChart,\n      salesChart,\n      customersChart,\n      sortableTable\n    };\n  }\n\n  renderComponents() {\n    Object.keys(this.subElements).forEach(key => {\n      this.subElements[key].append(this.components[key].element);\n    });\n  }\n\n  get template() {\n    return `\n        <div class=\"dashboard full-height flex-column\">\n\n            <div class=\"content__top-panel\">\n              <h2 class=\"page-title\">Dashboard</h2>\n              <!-- RangePicker -->\n              <div data-element=\"rangePicker\"></div>\n            </div>\n\n            <div class=\"dashboard__charts\">\n              <!-- ColumnCharts -->\n              <div data-element=\"ordersChart\" class=\"dashboard__chart_orders\"></div>\n              <div data-element=\"salesChart\" class=\"dashboard__chart_sales\"></div>\n              <div data-element=\"customersChart\" class=\"dashboard__chart_customers\"></div>\n            </div>\n\n            <h3 class=\"block-title\">Best sellers</h3>\n\n            <!-- SortableTable -->\n            <div data-element=\"sortableTable\" class=\"full-height flex-column\"></div>\n        </div>`;\n  }\n\n  async updateComponents(range) {\n    const {from, to} = range;\n    const fromISO = from.toISOString();\n    const toISO = to.toISOString();\n\n    const url = `api/dashboard/bestsellers?_start=0&_end=30&from=${fromISO}&to=${toISO}&_sort=title&_order=asc`;\n\n    this.components.sortableTable.update(url);\n\n    this.components.ordersChart.update(from, to);\n    this.components.salesChart.update(from, to);\n    this.components.customersChart.update(from, to);\n  }\n\n  initEventListeners() {\n    this.element.addEventListener('date-select', event => {\n      this.range = event.detail;\n\n      this.updateComponents(this.range);\n    });\n  }\n\n  getSubElements(element) {\n    const subElements = element.querySelectorAll('[data-element]');\n\n    return [...subElements].reduce((result, subElement) => {\n      result[subElement.dataset.element] = subElement;\n\n      return result;\n    }, {});\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = null;\n\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n","/*\nDate.prototype.setMonth():\nThe current day of month will have an impact on the behavior of this method.\nConceptually it will add the number of days given by the current day of the\nmonth to the 1st day of the new month specified as the parameter, to return the new date.\nFor example, if the current value is 31st August 2016, calling setMonth\nwith a value of 1 will return 2nd March 2016. This is because in 2016 February had 29 days.\n\nTo implement expected behaviour we use custom method.\n*/\nconst setUTCMonthCorrectly = (date, month) => {\n  const d = date.getUTCDate();\n  date.setUTCMonth(Number(month));\n  if (date.getUTCDate() !== d) {\n    date.setUTCDate(0);\n  }\n  return date;\n};\n\nexport default setUTCMonthCorrectly;\n","import fetchJson from \"../../utils/fetch-json.js\";\n\nconst BACKEND_URL = process.env.BACKEND_URL;\n\nexport default class SortableTable {\n  element = null;\n  subElements = {};\n  data = [];\n  loadStart = 0;\n  loadLength = 30;\n  isLoading = false;\n\n  pointerdownHandler = event => {\n    const target = event.target.closest('[data-sortable = \"true\"]');\n\n    if (!target) return;\n\n    event.preventDefault();\n\n    this.sorted.id = target.dataset.id;\n    this.sorted.order = (target.dataset.order === 'desc') ? 'asc' : 'desc';\n\n    Array.from(this.subElements.header.children).map(cell => cell.dataset.order = '');\n    target.dataset.order = this.sorted.order;\n\n    if (this.isSortLocally) {\n      this.sortOnClient(this.sorted.id, this.sorted.order);\n    } else {\n      this.sortOnServer(this.sorted.id, this.sorted.order);\n    }\n  }\n\n  scrollHandler = async event => {\n    if (this.isSortLocally) return;\n\n    let scrollHeight = Math.max(\n      document.body.scrollHeight, document.documentElement.scrollHeight,\n      document.body.offsetHeight, document.documentElement.offsetHeight,\n      document.body.clientHeight, document.documentElement.clientHeight\n    );\n\n    const firePointer = scrollHeight - document.documentElement.clientHeight;\n\n    if (window.pageYOffset === firePointer && !this.isLoading) {\n      this.loadStart = this.loadStart + this.loadLength;\n\n      this.isLoading = true;\n\n      const loadedData = await this.loadData();\n\n      if (loadedData.length === 0 || loadedData.length < this.loadLength) {\n        document.removeEventListener('scroll', this.scrollHandler);\n      }\n\n      this.updateTableData([...this.data, ...loadedData]);\n\n      this.isLoading = false;\n    }\n  }\n\n  constructor(headersConfig = [], {\n    url = '',\n    isSortLocally = false,\n    sorted = {\n      id: headersConfig.find(item => item.sortable).id,\n      order: 'asc'\n    },\n    emptyPlaceholder = '<div><p>No data</p></div>',\n    isRowALink = true\n  } = {}) {\n    this.url = url;\n    this.isSortLocally = isSortLocally;\n    this.headerConfig = headersConfig;\n    this.sorted = sorted;\n    this.emptyPlaceholder = emptyPlaceholder;\n    this.isRowALink = isRowALink;\n\n    this.render();\n  }\n\n  async render() {\n    const element = document.createElement('div');\n    const {id, order} = this.sorted;\n\n    element.innerHTML = this.getTable();\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    const data = await this.loadData(id, order);\n\n    this.subElements.header.innerHTML = this.getHeaderRow();\n\n    this.subElements.emptyPlaceholder.innerHTML = this.emptyPlaceholder;\n\n    this.updateTableData(data);\n    this.initEventListeners();\n  }\n\n  getTable() {\n    return `\n      <div class=\"sortable-table\">\n          <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\"></div>\n          <div data-element=\"body\" class=\"sortable-table__body\"></div>\n          <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\n          <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\"></div>\n      </div>\n    `;\n  }\n\n  getHeaderRow() {\n    return this.headerConfig.map(({id, sortable, title}) => {\n      const order = (id === this.sorted.id) ? this.sorted.order : '';\n\n      return `\n        <div class=\"sortable-table__cell\"\n            data-id=\"${id}\"\n            data-sortable=\"${sortable}\"\n            data-order=\"${order}\"\n            <span>${title}</span>\n            <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\n                <span class=\"sort-arrow\"></span>\n            </span>\n        </div>\n      `;\n    }).join('');\n  }\n\n  getBodyRows(data) {\n    return data.map(rowData => {\n      return this.isRowALink ?\n        `<a href=\"/products/${rowData.id}\" class=\"sortable-table__row\">${this.getBodyRow(rowData)}</a>` :\n        `<div class=\"sortable-table__row\">${this.getBodyRow(rowData)}</div>`;\n    }).join('');\n  }\n\n  getBodyRow(rowData) {\n    return Array.from(this.headerConfig).map(({id, template}) => {\n      if (template) {\n        return template(rowData[id]);\n      } else {\n        return `<div class=\"sortable-table__cell\">${rowData[id]}</div>`;\n      }\n    }).join('');\n  }\n\n  async update(url) {\n    this.url = url;\n    this.loadStart = 0;\n\n    const loadedData = await this.loadData();\n\n    if (loadedData.length) {\n      document.addEventListener('scroll', this.scrollHandler);\n    }\n    this.updateTableData(loadedData);\n  }\n\n  updateTableData(data) {\n    this.data = data;\n\n    if (data.length) {\n      this.element.classList.remove('sortable-table_empty');\n\n      if (this.isSortLocally) {\n        Array.from(this.subElements.header.children).map(cell => cell.dataset.order = '');\n      }\n\n      this.subElements.body.innerHTML = this.getBodyRows(data);\n    } else {\n      this.element.classList.add('sortable-table_empty');\n    }\n  }\n\n  sortOnClient(id, order) {\n    const sortedData = this.sort(id, order);\n\n    this.subElements.body.innerHTML = this.getBodyRows(sortedData);\n  }\n\n  async sortOnServer(id, order) {\n    this.loadStart = 0;\n\n    const loadedData = await this.loadData(id, order);\n\n    if (loadedData.length) {\n      document.addEventListener('scroll', this.scrollHandler);\n    }\n    this.updateTableData(loadedData);\n  }\n\n  sort(id, order) {\n    const column = this.headerConfig.find(item => item.id === id);\n    const {sortType, customSorting} = column;\n\n    return Array.from(this.data).sort((productA, productB) => {\n      const a = productA[id];\n      const b = productB[id];\n      let result = null;\n\n      switch (sortType) {\n        case 'number':\n          result = a - b;\n          break;\n        case 'string':\n          result = a.localeCompare(b, ['ru-u-kf-upper', 'en-u-kf-upper']);\n          break;\n        case 'date':\n          result = new Date(a) - new Date(b);\n          break;\n        case 'custom':\n          result = customSorting(a, b);\n          break;\n        default:\n          result = a - b;\n      }\n\n      if (order === 'asc') {\n        return result;\n      } else if (order === 'desc') {\n        return -result;\n      }\n    });\n  }\n\n  getSubElements(parentElement) {\n    const elements = parentElement.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  async loadData(sortId = this.sorted.id,\n                 sortOrder = this.sorted.order,\n                 start = this.loadStart,\n                 length = this.loadLength) {\n    if (!this.url) return;\n\n    this.setLoadingInd();\n\n    const url = new URL(this.url, BACKEND_URL);\n    url.searchParams.set('_sort', sortId);\n    url.searchParams.set('_order', sortOrder);\n    url.searchParams.set('_start', start.toString());\n    url.searchParams.set('_end', (start + length).toString());\n\n    let loadedData = [];\n\n    loadedData = await fetchJson(url.href);\n\n    this.removeLoadingInd();\n\n    return loadedData;\n  }\n\n  setLoadingInd() {\n    this.subElements.loading.style.display = 'block';\n  }\n\n  removeLoadingInd() {\n    this.subElements.loading.style.display = 'none';\n  }\n\n  initEventListeners () {\n    this.subElements.header.addEventListener('pointerdown', this.pointerdownHandler);\n    document.addEventListener('scroll', this.scrollHandler);\n  }\n\n  remove () {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    document.removeEventListener('scroll', this.scrollHandler);\n  }\n}\n","import setUTCMonthCorrectly from '../../utils/helpers.js';\n\nconst MONTHS_AT_ONE_TIME = 2;\nconst LAST_DAY_IN_A_WEEK = 7;\n\nexport default class RangePicker {\n  element = null;\n  subElements = {};\n  selectingFrom = true;\n\n  handleDatePick = event => {\n    const target = event.target;\n\n    if (!target.classList.contains('rangepicker__cell')) return;\n\n    const dateValue = new Date(target.dataset.value);\n\n    if (this.selectingFrom) {\n      this.removeSelected();\n\n      this.selectingFrom = false;\n      this.selected = {\n        from: dateValue,\n        to: null\n      };\n\n      this.highlightDates(this.selected);\n    } else {\n      if (dateValue < this.selected.from) {\n        this.selected.to = this.selected.from;\n        this.selected.from = dateValue;\n      } else {\n        this.selected.to = dateValue;\n      }\n\n      this.selectingFrom = true;\n\n      this.updateInput();\n      this.highlightDates(this.selected);\n      this.closeSelector();\n\n      this.element.dispatchEvent(new CustomEvent('date-select', {\n        bubbles: true,\n        detail: {\n          from: this.selected.from,\n          to: this.selected.to\n        }\n      }));\n    }\n  }\n\n  handleControlArrows = event => {\n    const className = event.target.className;\n    const direction = className.slice(className.lastIndexOf('-') + 1);\n    let month = this.showDateFrom.getUTCMonth();\n\n    if (direction === 'right') {\n      month += 1;\n    } else if (direction === 'left') {\n      month -= 1;\n    }\n\n    setUTCMonthCorrectly(this.showDateFrom, month);\n    this.renderSelector(this.showDateFrom);\n  };\n\n  toggleSelector = event => {\n    const selector = this.subElements.selector;\n\n    if (selector.innerHTML.trim() === '') {\n      this.renderSelector(this.selected.from);\n    }\n\n    this.element.classList.toggle('rangepicker_open');\n  }\n\n  handleClickOutside = event => {\n    const isOpen = this.element.classList.contains('rangepicker_open');\n    const isChildOfRangePicker = this.element.contains(event.target);\n\n    if (isOpen && !isChildOfRangePicker) {\n      this.closeSelector();\n    }\n  };\n\n  constructor({\n                from = new Date(),\n                to = new Date()\n              } = {}) {\n\n    this.selected = {\n      from: this.getUTCMidnight(from),\n      to: this.getUTCMidnight(to)\n    };\n    this.showDateFrom = new Date(this.selected.from.getTime());\n\n    this.render();\n    this.initEventListeners();\n  }\n\n  render() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = this.renderSkeleton(this.selected);\n    this.element = wrapper.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n  }\n\n  initEventListeners() {\n    const {selector, input} = this.subElements;\n\n    input.addEventListener('click', this.toggleSelector);\n    selector.addEventListener('click', this.handleDatePick);\n    document.addEventListener('click', this.handleClickOutside, true);\n  }\n\n  closeSelector() {\n    this.element.classList.remove('rangepicker_open');\n  }\n\n  updateInput() {\n    this.subElements.from.innerHTML = this.formatDate(this.selected.from);\n    this.subElements.to.innerHTML = this.formatDate(this.selected.to);\n  }\n\n  renderSelector(initialDate) {\n    const selector = this.subElements.selector;\n\n    selector.innerHTML = `\n      <div class=\"rangepicker__selector-arrow\"></div>\n      <div class=\"rangepicker__selector-control-left\"></div>\n      <div class=\"rangepicker__selector-control-right\"></div>`;\n\n    const arrowsClasses = '.rangepicker__selector-control-left, .rangepicker__selector-control-right';\n    const controlArrows = Array.from(selector.querySelectorAll(arrowsClasses));\n\n    if (controlArrows.length) {\n      controlArrows.forEach(arrow => {\n        arrow.addEventListener('click', this.handleControlArrows, true);\n      });\n    }\n\n    selector.insertAdjacentHTML('beforeend', this.renderMonths(initialDate));\n\n    this.highlightDates(this.selected);\n  }\n\n  highlightDates(selected) {\n    const fromTS = selected.from.getTime();\n    const toTS = selected.to ? selected.to.getTime() : null;\n    const datesButtons = this.getDatesButtons();\n    const firstButtonTS = Date.parse(datesButtons[0].dataset.value);\n    const lastButtonTS = Date.parse(datesButtons[datesButtons.length - 1].dataset.value);\n\n    if (selected.to) {\n      if (toTS < firstButtonTS || fromTS > lastButtonTS) return;\n    } else {\n      if (fromTS < firstButtonTS || fromTS > lastButtonTS) return;\n    }\n\n    datesButtons.forEach(button => {\n      let buttonDateTS = Date.parse(button.dataset.value);\n\n      if (buttonDateTS === fromTS) {\n        button.classList.add('rangepicker__selected-from');\n      }\n\n      if (!selected.to) return;\n\n      if (buttonDateTS > fromTS && buttonDateTS < toTS) {\n        button.classList.add('rangepicker__selected-between');\n      } else if (buttonDateTS === toTS) {\n        button.classList.add('rangepicker__selected-to');\n      }\n    });\n  }\n\n  getDatesButtons() {\n    return Array.from(this.subElements.selector.querySelectorAll('.rangepicker__cell'));\n  }\n\n  renderMonths(firstMonthDate) {\n    const months = [];\n    const initTime = firstMonthDate.getTime();\n    const month = firstMonthDate.getUTCMonth();\n\n    for (let i = 0; i < MONTHS_AT_ONE_TIME; i++) {\n      let date = new Date(initTime);\n\n      setUTCMonthCorrectly(date, month + i);\n\n      months.push(this.renderOneMoth(date));\n    }\n\n    return months.join('');\n  }\n\n  renderOneMoth(date) {\n    return `\n      <div class=\"rangepicker__calendar\">\n        <div class=\"rangepicker__month-indicator\">\n          <time datetime=\"${this.toDateTime(date)}\">\n            ${date.toLocaleDateString('ru', {month: 'long', timeZone: 'UTC'})}\n          </time>\n        </div>\n        <div class=\"rangepicker__day-of-week\">\n            <div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>\n        </div>\n        <div class=\"rangepicker__date-grid\">\n            ${this.renderDatesButtons(date)}\n        </div>\n      </div>`;\n  }\n\n  renderDatesButtons(initialDate) {\n    const date = new Date(initialDate.getTime());\n    const boundaryValues = this.getBoundaryValues(date);\n    const startFrom = boundaryValues.firstDayNumber === 0 ? LAST_DAY_IN_A_WEEK : boundaryValues.firstDayNumber;\n    const dateButtons = [];\n\n    for (let i = 1; i <= boundaryValues.lastDate; i++) {\n      date.setUTCDate(i);\n\n      dateButtons.push(`\n            <button type=\"button\"\n                class=\"rangepicker__cell\"\n                data-value=\"${date.toISOString()}\"\n                style=\"${i === 1 ? '--start-from: ' + startFrom : ''}\">\n                ${i}\n            </button>\n        `);\n    }\n\n    return dateButtons.join('');\n  }\n\n  getBoundaryValues(initialDate) {\n    const date = new Date(initialDate.getTime());\n\n    date.setUTCDate(1);\n    const firstDayNumber = date.getUTCDay();\n\n    setUTCMonthCorrectly(date, (date.getUTCMonth() + 1));\n    date.setUTCDate(0);\n    const lastDate = date.getUTCDate();\n\n    return {firstDayNumber, lastDate};\n  }\n\n  renderSkeleton(selected) {\n    return `\n      <div class=\"rangepicker\">\n        <div class=\"rangepicker__input\" data-element=\"input\">\n          <span data-element=\"from\">${this.formatDate(selected.from)}</span> -\n          <span data-element=\"to\">${this.formatDate(selected.to)}</span>\n        </div>\n         <div class=\"rangepicker__selector\" data-element=\"selector\"></div>\n      </div>`;\n  }\n\n  formatDate(dateToTransform) {\n    return dateToTransform.toLocaleDateString('ru', {dateStyle: 'short', timeZone: 'UTC'});\n  }\n\n  toDateTime(date) {\n    const month = date.getUTCMonth() + 1;\n\n    return `${date.getUTCFullYear()}-${('0' + month).slice(-2)}`;\n  }\n\n  removeSelected() {\n    const datesButtons = this.getDatesButtons();\n    const selectedClasses = ['rangepicker__selected-from', 'rangepicker__selected-between', 'rangepicker__selected-to'];\n\n    datesButtons.forEach(button => button.classList.remove.apply(button.classList, selectedClasses));\n  }\n\n  getSubElements(element) {\n    const subElements = element.querySelectorAll('[data-element]');\n\n    return Array.from(subElements).reduce((result, el) => {\n      result[el.dataset.element] = el;\n\n      return result;\n    }, {});\n  }\n\n  getUTCMidnight(date) {\n    return new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\n  }\n\n  remove() {\n    if (this.element) {\n      this.element.remove();\n    }\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    document.removeEventListener('click', this.handleClickOutside, true);\n  }\n}\n"],"sourceRoot":""}